{"ast":null,"code":"import { ApiController, ConnectorController, CoreHelperUtil, OptionsController, StorageUtil } from '@reown/appkit-controllers';\nimport { ConnectorUtil } from './ConnectorUtil.js';\nimport { ConstantsUtil } from './ConstantsUtil.js';\nexport const WalletUtil = {\n  filterOutDuplicatesByRDNS(wallets) {\n    const connectors = OptionsController.state.enableEIP6963 ? ConnectorController.state.connectors : [];\n    const recent = StorageUtil.getRecentWallets();\n    const connectorRDNSs = connectors.map(connector => connector.info?.rdns).filter(Boolean);\n    const recentRDNSs = recent.map(wallet => wallet.rdns).filter(Boolean);\n    const allRDNSs = connectorRDNSs.concat(recentRDNSs);\n    if (allRDNSs.includes('io.metamask.mobile') && CoreHelperUtil.isMobile()) {\n      const index = allRDNSs.indexOf('io.metamask.mobile');\n      allRDNSs[index] = 'io.metamask';\n    }\n    const filtered = wallets.filter(wallet => !allRDNSs.includes(String(wallet?.rdns)));\n    return filtered;\n  },\n  filterOutDuplicatesByIds(wallets) {\n    const connectors = ConnectorController.state.connectors.filter(connector => connector.type === 'ANNOUNCED' || connector.type === 'INJECTED');\n    const recent = StorageUtil.getRecentWallets();\n    const connectorIds = connectors.map(connector => connector.explorerId);\n    const recentIds = recent.map(wallet => wallet.id);\n    const allIds = connectorIds.concat(recentIds);\n    const filtered = wallets.filter(wallet => !allIds.includes(wallet?.id));\n    return filtered;\n  },\n  filterOutDuplicateWallets(wallets) {\n    const uniqueByRDNS = this.filterOutDuplicatesByRDNS(wallets);\n    const uniqueWallets = this.filterOutDuplicatesByIds(uniqueByRDNS);\n    return uniqueWallets;\n  },\n  markWalletsAsInstalled(wallets) {\n    const {\n      connectors\n    } = ConnectorController.state;\n    const installedConnectors = connectors.filter(c => c.type === 'ANNOUNCED').reduce((acum, val) => {\n      if (!val.info?.rdns) {\n        return acum;\n      }\n      acum[val.info.rdns] = true;\n      return acum;\n    }, {});\n    const walletsWithInstalled = wallets.map(wallet => ({\n      ...wallet,\n      installed: Boolean(wallet.rdns) && Boolean(installedConnectors[wallet.rdns ?? ''])\n    }));\n    const sortedWallets = walletsWithInstalled.sort((a, b) => Number(b.installed) - Number(a.installed));\n    return sortedWallets;\n  },\n  getConnectOrderMethod(_features, _connectors) {\n    const connectMethodOrder = _features?.connectMethodsOrder || OptionsController.state.features?.connectMethodsOrder;\n    const connectors = _connectors || ConnectorController.state.connectors;\n    if (connectMethodOrder) {\n      return connectMethodOrder;\n    }\n    const {\n      injected,\n      announced\n    } = ConnectorUtil.getConnectorsByType(connectors, ApiController.state.recommended, ApiController.state.featured);\n    const shownInjected = injected.filter(ConnectorUtil.showConnector);\n    const shownAnnounced = announced.filter(ConnectorUtil.showConnector);\n    if (shownInjected.length || shownAnnounced.length) {\n      return ['wallet', 'email', 'social'];\n    }\n    return ConstantsUtil.DEFAULT_CONNECT_METHOD_ORDER;\n  }\n};","map":{"version":3,"names":["ApiController","ConnectorController","CoreHelperUtil","OptionsController","StorageUtil","ConnectorUtil","ConstantsUtil","WalletUtil","filterOutDuplicatesByRDNS","wallets","connectors","state","enableEIP6963","recent","getRecentWallets","connectorRDNSs","map","connector","info","rdns","filter","Boolean","recentRDNSs","wallet","allRDNSs","concat","includes","isMobile","index","indexOf","filtered","String","filterOutDuplicatesByIds","type","connectorIds","explorerId","recentIds","id","allIds","filterOutDuplicateWallets","uniqueByRDNS","uniqueWallets","markWalletsAsInstalled","installedConnectors","c","reduce","acum","val","walletsWithInstalled","installed","sortedWallets","sort","a","b","Number","getConnectOrderMethod","_features","_connectors","connectMethodOrder","connectMethodsOrder","features","injected","announced","getConnectorsByType","recommended","featured","shownInjected","showConnector","shownAnnounced","length","DEFAULT_CONNECT_METHOD_ORDER"],"sources":["../../../../src/utils/WalletUtil.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}