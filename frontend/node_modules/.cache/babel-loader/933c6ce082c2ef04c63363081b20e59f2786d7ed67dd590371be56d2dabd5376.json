{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ServiceWorkerWindowChannel = void 0;\nconst connect_common_1 = require(\"@trezor/connect-common\");\nclass ServiceWorkerWindowChannel extends connect_common_1.AbstractMessageChannel {\n  port;\n  name;\n  allowSelfOrigin;\n  currentId;\n  constructor({\n    name,\n    channel,\n    logger,\n    lazyHandshake,\n    legacyMode,\n    allowSelfOrigin = false,\n    currentId\n  }) {\n    super({\n      channel,\n      sendFn: message => {\n        if (!this.port) throw new Error('port not assigned');\n        this.port.postMessage(message);\n      },\n      logger,\n      lazyHandshake,\n      legacyMode\n    });\n    this.name = name;\n    this.allowSelfOrigin = allowSelfOrigin;\n    this.currentId = currentId;\n    this.connect();\n  }\n  connect() {\n    chrome.runtime.onConnect.addListener(port => {\n      if (port.name !== this.name) return;\n      if (this.currentId?.() && this.currentId?.() !== port.sender?.tab?.id) return;\n      this.port = port;\n      this.port.onMessage.addListener((message, {\n        sender\n      }) => {\n        if (!sender) {\n          this.logger?.error('service-worker-window', 'no sender');\n          return;\n        }\n        const {\n          origin\n        } = sender;\n        const whitelist = ['https://connect.trezor.io', 'https://staging-connect.trezor.io', 'https://suite.corp.sldev.cz', 'https://dev.suite.sldev.cz', 'http://localhost:8088'];\n        const webextensionId = chrome?.runtime?.id;\n        if (webextensionId) {\n          whitelist.push(`chrome-extension://${webextensionId}`);\n        }\n        const webextensionUrl = chrome?.runtime?.getURL('');\n        if (webextensionUrl) {\n          whitelist.push(webextensionUrl.slice(0, -1));\n        }\n        if (!origin) {\n          this.logger?.error('connect-webextension/messageChannel/extensionPort/onMessage', 'no origin');\n          return;\n        }\n        if (!whitelist.includes(origin)) {\n          this.logger?.error('connect-webextension/messageChannel/extensionPort/onMessage', 'origin not whitelisted', origin);\n          return;\n        }\n        if (origin === self.origin && !this.allowSelfOrigin) {\n          return;\n        }\n        this.onMessage(message);\n      });\n    });\n    this.isConnected = true;\n  }\n  disconnect() {\n    if (!this.isConnected) return;\n    this.port?.disconnect();\n    this.clear();\n    this.isConnected = false;\n  }\n}\nexports.ServiceWorkerWindowChannel = ServiceWorkerWindowChannel;","map":{"version":3,"names":["Object","defineProperty","exports","value","ServiceWorkerWindowChannel","connect_common_1","require","AbstractMessageChannel","port","name","allowSelfOrigin","currentId","constructor","channel","logger","lazyHandshake","legacyMode","sendFn","message","Error","postMessage","connect","chrome","runtime","onConnect","addListener","sender","tab","id","onMessage","error","origin","whitelist","webextensionId","push","webextensionUrl","getURL","slice","includes","self","isConnected","disconnect","clear"],"sources":["C:/Users/yyash/Coding/solana-brkout/frontend/node_modules/@trezor/connect-web/lib/channels/serviceworker-window.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ServiceWorkerWindowChannel = void 0;\nconst connect_common_1 = require(\"@trezor/connect-common\");\nclass ServiceWorkerWindowChannel extends connect_common_1.AbstractMessageChannel {\n    port;\n    name;\n    allowSelfOrigin;\n    currentId;\n    constructor({ name, channel, logger, lazyHandshake, legacyMode, allowSelfOrigin = false, currentId, }) {\n        super({\n            channel,\n            sendFn: (message) => {\n                if (!this.port)\n                    throw new Error('port not assigned');\n                this.port.postMessage(message);\n            },\n            logger,\n            lazyHandshake,\n            legacyMode,\n        });\n        this.name = name;\n        this.allowSelfOrigin = allowSelfOrigin;\n        this.currentId = currentId;\n        this.connect();\n    }\n    connect() {\n        chrome.runtime.onConnect.addListener(port => {\n            if (port.name !== this.name)\n                return;\n            if (this.currentId?.() && this.currentId?.() !== port.sender?.tab?.id)\n                return;\n            this.port = port;\n            this.port.onMessage.addListener((message, { sender }) => {\n                if (!sender) {\n                    this.logger?.error('service-worker-window', 'no sender');\n                    return;\n                }\n                const { origin } = sender;\n                const whitelist = [\n                    'https://connect.trezor.io',\n                    'https://staging-connect.trezor.io',\n                    'https://suite.corp.sldev.cz',\n                    'https://dev.suite.sldev.cz',\n                    'http://localhost:8088',\n                ];\n                const webextensionId = chrome?.runtime?.id;\n                if (webextensionId) {\n                    whitelist.push(`chrome-extension://${webextensionId}`);\n                }\n                const webextensionUrl = chrome?.runtime?.getURL('');\n                if (webextensionUrl) {\n                    whitelist.push(webextensionUrl.slice(0, -1));\n                }\n                if (!origin) {\n                    this.logger?.error('connect-webextension/messageChannel/extensionPort/onMessage', 'no origin');\n                    return;\n                }\n                if (!whitelist.includes(origin)) {\n                    this.logger?.error('connect-webextension/messageChannel/extensionPort/onMessage', 'origin not whitelisted', origin);\n                    return;\n                }\n                if (origin === self.origin && !this.allowSelfOrigin) {\n                    return;\n                }\n                this.onMessage(message);\n            });\n        });\n        this.isConnected = true;\n    }\n    disconnect() {\n        if (!this.isConnected)\n            return;\n        this.port?.disconnect();\n        this.clear();\n        this.isConnected = false;\n    }\n}\nexports.ServiceWorkerWindowChannel = ServiceWorkerWindowChannel;\n//# sourceMappingURL=serviceworker-window.js.map"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}