{"ast":null,"code":"// -- Types --------------------------------------------- //\nimport { NumberUtil } from '@reown/appkit-common';\n// -- Util ---------------------------------------- //\nexport const SwapCalculationUtil = {\n  getGasPriceInEther(gas, gasPrice) {\n    const totalGasCostInWei = gasPrice * gas;\n    const totalGasCostInEther = Number(totalGasCostInWei) / 1e18;\n    return totalGasCostInEther;\n  },\n  getGasPriceInUSD(networkPrice, gas, gasPrice) {\n    const totalGasCostInEther = SwapCalculationUtil.getGasPriceInEther(gas, gasPrice);\n    const networkPriceInUSD = NumberUtil.bigNumber(networkPrice);\n    const gasCostInUSD = networkPriceInUSD.times(totalGasCostInEther);\n    return gasCostInUSD.toNumber();\n  },\n  getPriceImpact({\n    sourceTokenAmount,\n    sourceTokenPriceInUSD,\n    toTokenPriceInUSD,\n    toTokenAmount\n  }) {\n    const inputValue = NumberUtil.bigNumber(sourceTokenAmount).times(sourceTokenPriceInUSD);\n    const outputValue = NumberUtil.bigNumber(toTokenAmount).times(toTokenPriceInUSD);\n    const priceImpact = inputValue.minus(outputValue).div(inputValue).times(100);\n    return priceImpact.toNumber();\n  },\n  getMaxSlippage(slippage, toTokenAmount) {\n    const slippageToleranceDecimal = NumberUtil.bigNumber(slippage).div(100);\n    const maxSlippageAmount = NumberUtil.multiply(toTokenAmount, slippageToleranceDecimal);\n    return maxSlippageAmount.toNumber();\n  },\n  getProviderFee(sourceTokenAmount, feePercentage = 0.0085) {\n    const providerFee = NumberUtil.bigNumber(sourceTokenAmount).times(feePercentage);\n    return providerFee.toString();\n  },\n  isInsufficientNetworkTokenForGas(networkBalanceInUSD, gasPriceInUSD) {\n    const gasPrice = gasPriceInUSD || '0';\n    if (NumberUtil.bigNumber(networkBalanceInUSD).eq(0)) {\n      return true;\n    }\n    return NumberUtil.bigNumber(NumberUtil.bigNumber(gasPrice)).gt(networkBalanceInUSD);\n  },\n  isInsufficientSourceTokenForSwap(sourceTokenAmount, sourceTokenAddress, balance) {\n    const sourceTokenBalance = balance?.find(token => token.address === sourceTokenAddress)?.quantity?.numeric;\n    const isInSufficientBalance = NumberUtil.bigNumber(sourceTokenBalance || '0').lt(sourceTokenAmount);\n    return isInSufficientBalance;\n  },\n  getToTokenAmount({\n    sourceToken,\n    toToken,\n    sourceTokenPrice,\n    toTokenPrice,\n    sourceTokenAmount\n  }) {\n    if (sourceTokenAmount === '0') {\n      return '0';\n    }\n    if (!sourceToken || !toToken) {\n      return '0';\n    }\n    const sourceTokenDecimals = sourceToken.decimals;\n    const sourceTokenPriceInUSD = sourceTokenPrice;\n    const toTokenDecimals = toToken.decimals;\n    const toTokenPriceInUSD = toTokenPrice;\n    if (toTokenPriceInUSD <= 0) {\n      return '0';\n    }\n    // Calculate the provider fee (0.85% of the source token amount)\n    const providerFee = NumberUtil.bigNumber(sourceTokenAmount).times(0.0085);\n    // Adjust the source token amount by subtracting the provider fee\n    const adjustedSourceTokenAmount = NumberUtil.bigNumber(sourceTokenAmount).minus(providerFee);\n    // Proceed with conversion using the adjusted source token amount\n    const sourceAmountInSmallestUnit = adjustedSourceTokenAmount.times(NumberUtil.bigNumber(10).pow(sourceTokenDecimals));\n    const priceRatio = NumberUtil.bigNumber(sourceTokenPriceInUSD).div(toTokenPriceInUSD);\n    const decimalDifference = sourceTokenDecimals - toTokenDecimals;\n    const toTokenAmountInSmallestUnit = sourceAmountInSmallestUnit.times(priceRatio).div(NumberUtil.bigNumber(10).pow(decimalDifference));\n    const toTokenAmount = toTokenAmountInSmallestUnit.div(NumberUtil.bigNumber(10).pow(toTokenDecimals));\n    const amount = toTokenAmount.toFixed(toTokenDecimals).toString();\n    return amount;\n  }\n};","map":{"version":3,"names":["NumberUtil","SwapCalculationUtil","getGasPriceInEther","gas","gasPrice","totalGasCostInWei","totalGasCostInEther","Number","getGasPriceInUSD","networkPrice","networkPriceInUSD","bigNumber","gasCostInUSD","times","toNumber","getPriceImpact","sourceTokenAmount","sourceTokenPriceInUSD","toTokenPriceInUSD","toTokenAmount","inputValue","outputValue","priceImpact","minus","div","getMaxSlippage","slippage","slippageToleranceDecimal","maxSlippageAmount","multiply","getProviderFee","feePercentage","providerFee","toString","isInsufficientNetworkTokenForGas","networkBalanceInUSD","gasPriceInUSD","eq","gt","isInsufficientSourceTokenForSwap","sourceTokenAddress","balance","sourceTokenBalance","find","token","address","quantity","numeric","isInSufficientBalance","lt","getToTokenAmount","sourceToken","toToken","sourceTokenPrice","toTokenPrice","sourceTokenDecimals","decimals","toTokenDecimals","adjustedSourceTokenAmount","sourceAmountInSmallestUnit","pow","priceRatio","decimalDifference","toTokenAmountInSmallestUnit","amount","toFixed"],"sources":["../../../../src/utils/SwapCalculationUtil.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}