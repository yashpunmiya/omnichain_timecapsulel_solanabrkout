{"ast":null,"code":"var __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { LitElement, html } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { AssetUtil, ConnectionController, CoreHelperUtil, RouterController, SnackController, ThemeController } from '@reown/appkit-controllers';\nimport '@reown/appkit-ui/wui-button';\nimport '@reown/appkit-ui/wui-flex';\nimport '@reown/appkit-ui/wui-icon';\nimport '@reown/appkit-ui/wui-icon-box';\nimport '@reown/appkit-ui/wui-link';\nimport '@reown/appkit-ui/wui-loading-thumbnail';\nimport '@reown/appkit-ui/wui-text';\nimport '@reown/appkit-ui/wui-wallet-image';\nimport '../../partials/w3m-mobile-download-links/index.js';\nimport styles from './styles.js';\nexport class W3mConnectingWidget extends LitElement {\n  constructor() {\n    super();\n    this.wallet = RouterController.state.data?.wallet;\n    this.connector = RouterController.state.data?.connector;\n    this.timeout = undefined;\n    this.secondaryBtnIcon = 'refresh';\n    this.onConnect = undefined;\n    this.onRender = undefined;\n    this.onAutoConnect = undefined;\n    this.isWalletConnect = true;\n    this.unsubscribe = [];\n    this.imageSrc = AssetUtil.getWalletImage(this.wallet) ?? AssetUtil.getConnectorImage(this.connector);\n    this.name = this.wallet?.name ?? this.connector?.name ?? 'Wallet';\n    this.isRetrying = false;\n    this.uri = ConnectionController.state.wcUri;\n    this.error = ConnectionController.state.wcError;\n    this.ready = false;\n    this.showRetry = false;\n    this.secondaryBtnLabel = 'Try again';\n    this.secondaryLabel = 'Accept connection request in the wallet';\n    this.buffering = false;\n    this.isLoading = false;\n    this.isMobile = false;\n    this.onRetry = undefined;\n    this.unsubscribe.push(...[ConnectionController.subscribeKey('wcUri', val => {\n      this.uri = val;\n      if (this.isRetrying && this.onRetry) {\n        this.isRetrying = false;\n        this.onConnect?.();\n      }\n    }), ConnectionController.subscribeKey('wcError', val => this.error = val), ConnectionController.subscribeKey('buffering', val => this.buffering = val)]);\n    if ((CoreHelperUtil.isTelegram() || CoreHelperUtil.isSafari()) && CoreHelperUtil.isIos() && ConnectionController.state.wcUri) {\n      this.onConnect?.();\n    }\n  }\n  firstUpdated() {\n    this.onAutoConnect?.();\n    this.showRetry = !this.onAutoConnect;\n  }\n  disconnectedCallback() {\n    this.unsubscribe.forEach(unsubscribe => unsubscribe());\n    clearTimeout(this.timeout);\n  }\n  render() {\n    this.onRender?.();\n    this.onShowRetry();\n    const subLabel = this.error ? 'Connection can be declined if a previous request is still active' : this.secondaryLabel;\n    let label = `Continue in ${this.name}`;\n    if (this.buffering) {\n      label = 'Connecting...';\n    }\n    if (this.error) {\n      label = 'Connection declined';\n    }\n    return html`\n      <wui-flex\n        data-error=${ifDefined(this.error)}\n        data-retry=${this.showRetry}\n        flexDirection=\"column\"\n        alignItems=\"center\"\n        .padding=${['3xl', 'xl', 'xl', 'xl']}\n        gap=\"xl\"\n      >\n        <wui-flex justifyContent=\"center\" alignItems=\"center\">\n          <wui-wallet-image size=\"lg\" imageSrc=${ifDefined(this.imageSrc)}></wui-wallet-image>\n\n          ${this.error ? null : this.loaderTemplate()}\n\n          <wui-icon-box\n            backgroundColor=\"error-100\"\n            background=\"opaque\"\n            iconColor=\"error-100\"\n            icon=\"close\"\n            size=\"sm\"\n            border\n            borderColor=\"wui-color-bg-125\"\n          ></wui-icon-box>\n        </wui-flex>\n\n        <wui-flex flexDirection=\"column\" alignItems=\"center\" gap=\"xs\">\n          <wui-text variant=\"paragraph-500\" color=${this.error ? 'error-100' : 'fg-100'}>\n            ${label}\n          </wui-text>\n          <wui-text align=\"center\" variant=\"small-500\" color=\"fg-200\">${subLabel}</wui-text>\n        </wui-flex>\n\n        ${this.secondaryBtnLabel ? html`\n              <wui-button\n                variant=\"accent\"\n                size=\"md\"\n                ?disabled=${this.isRetrying || !this.error && this.buffering || this.isLoading}\n                @click=${this.onTryAgain.bind(this)}\n                data-testid=\"w3m-connecting-widget-secondary-button\"\n              >\n                <wui-icon color=\"inherit\" slot=\"iconLeft\" name=${this.secondaryBtnIcon}></wui-icon>\n                ${this.secondaryBtnLabel}\n              </wui-button>\n            ` : null}\n      </wui-flex>\n\n      ${this.isWalletConnect ? html`\n            <wui-flex .padding=${['0', 'xl', 'xl', 'xl']} justifyContent=\"center\">\n              <wui-link @click=${this.onCopyUri} color=\"fg-200\" data-testid=\"wui-link-copy\">\n                <wui-icon size=\"xs\" color=\"fg-200\" slot=\"iconLeft\" name=\"copy\"></wui-icon>\n                Copy link\n              </wui-link>\n            </wui-flex>\n          ` : null}\n\n      <w3m-mobile-download-links .wallet=${this.wallet}></w3m-mobile-download-links>\n    `;\n  }\n  onShowRetry() {\n    if (this.error && !this.showRetry) {\n      this.showRetry = true;\n      const retryButton = this.shadowRoot?.querySelector('wui-button');\n      retryButton?.animate([{\n        opacity: 0\n      }, {\n        opacity: 1\n      }], {\n        fill: 'forwards',\n        easing: 'ease'\n      });\n    }\n  }\n  onTryAgain() {\n    if (!this.buffering) {\n      ConnectionController.setWcError(false);\n      if (this.onRetry) {\n        this.isRetrying = true;\n        this.onRetry?.();\n      } else {\n        this.onConnect?.();\n      }\n    }\n  }\n  loaderTemplate() {\n    const borderRadiusMaster = ThemeController.state.themeVariables['--w3m-border-radius-master'];\n    const radius = borderRadiusMaster ? parseInt(borderRadiusMaster.replace('px', ''), 10) : 4;\n    return html`<wui-loading-thumbnail radius=${radius * 9}></wui-loading-thumbnail>`;\n  }\n  onCopyUri() {\n    try {\n      if (this.uri) {\n        CoreHelperUtil.copyToClopboard(this.uri);\n        SnackController.showSuccess('Link copied');\n      }\n    } catch {\n      SnackController.showError('Failed to copy');\n    }\n  }\n}\nW3mConnectingWidget.styles = styles;\n__decorate([state()], W3mConnectingWidget.prototype, \"isRetrying\", void 0);\n__decorate([state()], W3mConnectingWidget.prototype, \"uri\", void 0);\n__decorate([state()], W3mConnectingWidget.prototype, \"error\", void 0);\n__decorate([state()], W3mConnectingWidget.prototype, \"ready\", void 0);\n__decorate([state()], W3mConnectingWidget.prototype, \"showRetry\", void 0);\n__decorate([state()], W3mConnectingWidget.prototype, \"secondaryBtnLabel\", void 0);\n__decorate([state()], W3mConnectingWidget.prototype, \"secondaryLabel\", void 0);\n__decorate([state()], W3mConnectingWidget.prototype, \"buffering\", void 0);\n__decorate([state()], W3mConnectingWidget.prototype, \"isLoading\", void 0);\n__decorate([property({\n  type: Boolean\n})], W3mConnectingWidget.prototype, \"isMobile\", void 0);\n__decorate([property()], W3mConnectingWidget.prototype, \"onRetry\", void 0);","map":{"version":3,"names":["LitElement","html","property","state","ifDefined","AssetUtil","ConnectionController","CoreHelperUtil","RouterController","SnackController","ThemeController","styles","W3mConnectingWidget","constructor","wallet","data","connector","timeout","undefined","secondaryBtnIcon","onConnect","onRender","onAutoConnect","isWalletConnect","unsubscribe","imageSrc","getWalletImage","getConnectorImage","name","isRetrying","uri","wcUri","error","wcError","ready","showRetry","secondaryBtnLabel","secondaryLabel","buffering","isLoading","isMobile","onRetry","push","subscribeKey","val","isTelegram","isSafari","isIos","firstUpdated","disconnectedCallback","forEach","clearTimeout","render","onShowRetry","subLabel","label","loaderTemplate","onTryAgain","bind","onCopyUri","retryButton","shadowRoot","querySelector","animate","opacity","fill","easing","setWcError","borderRadiusMaster","themeVariables","radius","parseInt","replace","copyToClopboard","showSuccess","showError","__decorate","type","Boolean"],"sources":["../../../../../src/utils/w3m-connecting-widget/index.ts"],"sourcesContent":[null],"mappings":";;;;;;;AAAA,SAASA,UAAU,EAAEC,IAAI,QAAQ,KAAK;AACtC,SAASC,QAAQ,EAAEC,KAAK,QAAQ,mBAAmB;AACnD,SAASC,SAAS,QAAQ,8BAA8B;AAExD,SACEC,SAAS,EACTC,oBAAoB,EACpBC,cAAc,EACdC,gBAAgB,EAChBC,eAAe,EACfC,eAAe,QACV,2BAA2B;AAElC,OAAO,6BAA6B;AACpC,OAAO,2BAA2B;AAClC,OAAO,2BAA2B;AAClC,OAAO,+BAA+B;AACtC,OAAO,2BAA2B;AAClC,OAAO,wCAAwC;AAC/C,OAAO,2BAA2B;AAClC,OAAO,mCAAmC;AAE1C,OAAO,mDAAmD;AAC1D,OAAOC,MAAM,MAAM,aAAa;AAEhC,OAAM,MAAOC,mBAAoB,SAAQZ,UAAU;EAkDjDa,YAAA;IACE,KAAK,EAAE;IA/CU,KAAAC,MAAM,GAAGN,gBAAgB,CAACL,KAAK,CAACY,IAAI,EAAED,MAAM;IAE5C,KAAAE,SAAS,GAAGR,gBAAgB,CAACL,KAAK,CAACY,IAAI,EAAEC,SAAS;IAE3D,KAAAC,OAAO,GAAmCC,SAAS;IAEnD,KAAAC,gBAAgB,GAAa,SAAS;IAEtC,KAAAC,SAAS,GAA0CF,SAAS;IAE5D,KAAAG,QAAQ,GAA0CH,SAAS;IAE3D,KAAAI,aAAa,GAA0CJ,SAAS;IAEhE,KAAAK,eAAe,GAAG,IAAI;IAEtB,KAAAC,WAAW,GAAmB,EAAE;IAElC,KAAAC,QAAQ,GACdpB,SAAS,CAACqB,cAAc,CAAC,IAAI,CAACZ,MAAM,CAAC,IAAIT,SAAS,CAACsB,iBAAiB,CAAC,IAAI,CAACX,SAAS,CAAC;IAE9E,KAAAY,IAAI,GAAG,IAAI,CAACd,MAAM,EAAEc,IAAI,IAAI,IAAI,CAACZ,SAAS,EAAEY,IAAI,IAAI,QAAQ;IAGjD,KAAAC,UAAU,GAAG,KAAK;IAElB,KAAAC,GAAG,GAAGxB,oBAAoB,CAACH,KAAK,CAAC4B,KAAK;IAEtC,KAAAC,KAAK,GAAG1B,oBAAoB,CAACH,KAAK,CAAC8B,OAAO;IAE1C,KAAAC,KAAK,GAAG,KAAK;IAEf,KAAAC,SAAS,GAAG,KAAK;IAEf,KAAAC,iBAAiB,GAAI,WAAW;IAEhC,KAAAC,cAAc,GAAG,yCAAyC;IAE7D,KAAAC,SAAS,GAAG,KAAK;IAEd,KAAAC,SAAS,GAAG,KAAK;IAEA,KAAAC,QAAQ,GAAG,KAAK;IAEjC,KAAAC,OAAO,GAA0CvB,SAAS;IAI3E,IAAI,CAACM,WAAW,CAACkB,IAAI,CACnB,GAAG,CACDpC,oBAAoB,CAACqC,YAAY,CAAC,OAAO,EAAEC,GAAG,IAAG;MAC/C,IAAI,CAACd,GAAG,GAAGc,GAAG;MACd,IAAI,IAAI,CAACf,UAAU,IAAI,IAAI,CAACY,OAAO,EAAE;QACnC,IAAI,CAACZ,UAAU,GAAG,KAAK;QACvB,IAAI,CAACT,SAAS,GAAE,CAAE;MACpB;IACF,CAAC,CAAC,EACFd,oBAAoB,CAACqC,YAAY,CAAC,SAAS,EAAEC,GAAG,IAAK,IAAI,CAACZ,KAAK,GAAGY,GAAI,CAAC,EACvEtC,oBAAoB,CAACqC,YAAY,CAAC,WAAW,EAAEC,GAAG,IAAK,IAAI,CAACN,SAAS,GAAGM,GAAI,CAAC,CAC9E,CACF;IAED,IACE,CAACrC,cAAc,CAACsC,UAAU,EAAE,IAAItC,cAAc,CAACuC,QAAQ,EAAE,KACzDvC,cAAc,CAACwC,KAAK,EAAE,IACtBzC,oBAAoB,CAACH,KAAK,CAAC4B,KAAK,EAChC;MACA,IAAI,CAACX,SAAS,GAAE,CAAE;IACpB;EACF;EAEgB4B,YAAYA,CAAA;IAC1B,IAAI,CAAC1B,aAAa,GAAE,CAAE;IACtB,IAAI,CAACa,SAAS,GAAG,CAAC,IAAI,CAACb,aAAa;EACtC;EAEgB2B,oBAAoBA,CAAA;IAClC,IAAI,CAACzB,WAAW,CAAC0B,OAAO,CAAC1B,WAAW,IAAIA,WAAW,EAAE,CAAC;IACtD2B,YAAY,CAAC,IAAI,CAAClC,OAAO,CAAC;EAC5B;EAGgBmC,MAAMA,CAAA;IACpB,IAAI,CAAC/B,QAAQ,GAAE,CAAE;IACjB,IAAI,CAACgC,WAAW,EAAE;IAElB,MAAMC,QAAQ,GAAG,IAAI,CAACtB,KAAK,GACvB,kEAAkE,GAClE,IAAI,CAACK,cAAc;IAEvB,IAAIkB,KAAK,GAAG,eAAe,IAAI,CAAC3B,IAAI,EAAE;IAEtC,IAAI,IAAI,CAACU,SAAS,EAAE;MAClBiB,KAAK,GAAG,eAAe;IACzB;IAEA,IAAI,IAAI,CAACvB,KAAK,EAAE;MACduB,KAAK,GAAG,qBAAqB;IAC/B;IAEA,OAAOtD,IAAI;;qBAEMG,SAAS,CAAC,IAAI,CAAC4B,KAAK,CAAC;qBACrB,IAAI,CAACG,SAAS;;;mBAGhB,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAU;;;;iDAIJ/B,SAAS,CAAC,IAAI,CAACqB,QAAQ,CAAC;;YAE7D,IAAI,CAACO,KAAK,GAAG,IAAI,GAAG,IAAI,CAACwB,cAAc,EAAE;;;;;;;;;;;;;;oDAcD,IAAI,CAACxB,KAAK,GAAG,WAAW,GAAG,QAAQ;cACzEuB,KAAK;;wEAEqDD,QAAQ;;;UAGtE,IAAI,CAAClB,iBAAiB,GACpBnC,IAAI;;;;4BAIY,IAAI,CAAC4B,UAAU,IAAK,CAAC,IAAI,CAACG,KAAK,IAAI,IAAI,CAACM,SAAU,IAAI,IAAI,CAACC,SAAS;yBACvE,IAAI,CAACkB,UAAU,CAACC,IAAI,CAAC,IAAI,CAAC;;;iEAGc,IAAI,CAACvC,gBAAgB;kBACpE,IAAI,CAACiB,iBAAiB;;aAE3B,GACD,IAAI;;;QAGR,IAAI,CAACb,eAAe,GAClBtB,IAAI;iCACmB,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAU;iCAChC,IAAI,CAAC0D,SAAS;;;;;WAKpC,GACD,IAAI;;2CAE6B,IAAI,CAAC7C,MAAM;KACjD;EACH;EAGQuC,WAAWA,CAAA;IACjB,IAAI,IAAI,CAACrB,KAAK,IAAI,CAAC,IAAI,CAACG,SAAS,EAAE;MACjC,IAAI,CAACA,SAAS,GAAG,IAAI;MACrB,MAAMyB,WAAW,GAAG,IAAI,CAACC,UAAU,EAAEC,aAAa,CAAC,YAAY,CAAgB;MAC/EF,WAAW,EAAEG,OAAO,CAAC,CAAC;QAAEC,OAAO,EAAE;MAAC,CAAE,EAAE;QAAEA,OAAO,EAAE;MAAC,CAAE,CAAC,EAAE;QACrDC,IAAI,EAAE,UAAU;QAChBC,MAAM,EAAE;OACT,CAAC;IACJ;EACF;EAEUT,UAAUA,CAAA;IAClB,IAAI,CAAC,IAAI,CAACnB,SAAS,EAAE;MACnBhC,oBAAoB,CAAC6D,UAAU,CAAC,KAAK,CAAC;MACtC,IAAI,IAAI,CAAC1B,OAAO,EAAE;QAChB,IAAI,CAACZ,UAAU,GAAG,IAAI;QACtB,IAAI,CAACY,OAAO,GAAE,CAAE;MAClB,CAAC,MAAM;QACL,IAAI,CAACrB,SAAS,GAAE,CAAE;MACpB;IACF;EACF;EAEQoC,cAAcA,CAAA;IACpB,MAAMY,kBAAkB,GAAG1D,eAAe,CAACP,KAAK,CAACkE,cAAc,CAAC,4BAA4B,CAAC;IAC7F,MAAMC,MAAM,GAAGF,kBAAkB,GAAGG,QAAQ,CAACH,kBAAkB,CAACI,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC;IAE1F,OAAOvE,IAAI,iCAAiCqE,MAAM,GAAG,CAAC,2BAA2B;EACnF;EAGUX,SAASA,CAAA;IACjB,IAAI;MACF,IAAI,IAAI,CAAC7B,GAAG,EAAE;QACZvB,cAAc,CAACkE,eAAe,CAAC,IAAI,CAAC3C,GAAG,CAAC;QACxCrB,eAAe,CAACiE,WAAW,CAAC,aAAa,CAAC;MAC5C;IACF,CAAC,CAAC,MAAM;MACNjE,eAAe,CAACkE,SAAS,CAAC,gBAAgB,CAAC;IAC7C;EACF;;AA/MuB/D,mBAAA,CAAAD,MAAM,GAAGA,MAAM;AA2BnBiE,UAAA,EAAlBzE,KAAK,EAAE,C,sDAA6B;AAElByE,UAAA,EAAlBzE,KAAK,EAAE,C,+CAAiD;AAEtCyE,UAAA,EAAlBzE,KAAK,EAAE,C,iDAAqD;AAE1CyE,UAAA,EAAlBzE,KAAK,EAAE,C,iDAAwB;AAEfyE,UAAA,EAAhBzE,KAAK,EAAE,C,qDAA0B;AAEfyE,UAAA,EAAlBzE,KAAK,EAAE,C,6DAA2C;AAEhCyE,UAAA,EAAlBzE,KAAK,EAAE,C,0DAAqE;AAE7DyE,UAAA,EAAfzE,KAAK,EAAE,C,qDAAyB;AAEdyE,UAAA,EAAlBzE,KAAK,EAAE,C,qDAA4B;AAEAyE,UAAA,EAAnC1E,QAAQ,CAAC;EAAE2E,IAAI,EAAEC;AAAO,CAAE,CAAC,C,oDAAwB;AAEjCF,UAAA,EAAlB1E,QAAQ,EAAE,C,mDAAkE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}