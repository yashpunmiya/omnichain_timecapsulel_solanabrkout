{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.scheduleAction = void 0;\nconst isArray = attempts => Array.isArray(attempts);\nconst resolveAfterMs = (ms, clear) => new Promise((resolve, reject) => {\n  if (clear.aborted) return reject();\n  if (ms === undefined) return resolve();\n  let timeout;\n  const onClear = () => {\n    clearTimeout(timeout);\n    clear.removeEventListener('abort', onClear);\n    reject();\n  };\n  timeout = setTimeout(() => {\n    clear.removeEventListener('abort', onClear);\n    resolve();\n  }, ms);\n  clear.addEventListener('abort', onClear);\n});\nconst rejectAfterMs = (ms, reason, clear) => new Promise((_, reject) => {\n  if (clear.aborted) return reject();\n  let timeout;\n  const onClear = () => {\n    clearTimeout(timeout);\n    clear.removeEventListener('abort', onClear);\n    reject();\n  };\n  timeout = setTimeout(() => {\n    clear.removeEventListener('abort', onClear);\n    reject(reason);\n  }, ms);\n  clear.addEventListener('abort', onClear);\n});\nconst maybeRejectAfterMs = (ms, reason, clear) => ms === undefined ? [] : [rejectAfterMs(ms, reason, clear)];\nconst rejectWhenAborted = (signal, clear) => new Promise((_, reject) => {\n  if (clear.aborted) return reject();\n  const errorSignal = new Error('Aborted by signal');\n  if (signal?.aborted) return reject(errorSignal);\n  const onAbort = () => reject(errorSignal);\n  signal?.addEventListener('abort', onAbort);\n  const onClear = () => {\n    signal?.removeEventListener('abort', onAbort);\n    clear.removeEventListener('abort', onClear);\n    reject();\n  };\n  clear.addEventListener('abort', onClear);\n});\nconst resolveAction = async (action, clear) => {\n  const aborter = new AbortController();\n  if (clear.aborted) aborter.abort();\n  const onClear = () => {\n    clear.removeEventListener('abort', onClear);\n    aborter.abort();\n  };\n  clear.addEventListener('abort', onClear);\n  try {\n    return await new Promise(resolve => resolve(action(aborter.signal)));\n  } finally {\n    if (!clear.aborted) clear.removeEventListener('abort', onClear);\n  }\n};\nconst attemptLoop = async (attempts, attempt, failure, clear) => {\n  for (let a = 0; a < attempts - 1; a++) {\n    if (clear.aborted) break;\n    const aborter = new AbortController();\n    const onClear = () => aborter.abort();\n    clear.addEventListener('abort', onClear);\n    try {\n      return await attempt(a, aborter.signal);\n    } catch (error) {\n      onClear();\n      await failure(a, error);\n    } finally {\n      clear.removeEventListener('abort', onClear);\n    }\n  }\n  return clear.aborted ? Promise.reject() : attempt(attempts - 1, clear);\n};\nconst scheduleAction = async (action, params) => {\n  const {\n    signal,\n    delay,\n    attempts,\n    timeout,\n    deadline,\n    gap,\n    attemptFailureHandler\n  } = params;\n  const deadlineMs = deadline && deadline - Date.now();\n  const attemptCount = isArray(attempts) ? attempts.length : attempts ?? (deadline ? Infinity : 1);\n  const clearAborter = new AbortController();\n  const clear = clearAborter.signal;\n  const getParams = isArray(attempts) ? attempt => attempts[attempt] : () => ({\n    timeout,\n    gap\n  });\n  const errorDeadline = new Error('Aborted by deadline');\n  const errorTimeout = new Error('Aborted by timeout');\n  try {\n    return await Promise.race([rejectWhenAborted(signal, clear), ...maybeRejectAfterMs(deadlineMs, errorDeadline, clear), resolveAfterMs(delay, clear).then(() => attemptLoop(attemptCount, (attempt, abort) => Promise.race([...maybeRejectAfterMs(getParams(attempt).timeout, errorTimeout, clear), resolveAction(action, abort)]), (attempt, error) => {\n      const errorHandlerResult = attemptFailureHandler?.(error);\n      return errorHandlerResult ? Promise.reject(errorHandlerResult) : resolveAfterMs(getParams(attempt).gap ?? 0, clear);\n    }, clear))]);\n  } finally {\n    clearAborter.abort();\n  }\n};\nexports.scheduleAction = scheduleAction;","map":{"version":3,"names":["Object","defineProperty","exports","value","scheduleAction","isArray","attempts","Array","resolveAfterMs","ms","clear","Promise","resolve","reject","aborted","undefined","timeout","onClear","clearTimeout","removeEventListener","setTimeout","addEventListener","rejectAfterMs","reason","_","maybeRejectAfterMs","rejectWhenAborted","signal","errorSignal","Error","onAbort","resolveAction","action","aborter","AbortController","abort","attemptLoop","attempt","failure","a","error","params","delay","deadline","gap","attemptFailureHandler","deadlineMs","Date","now","attemptCount","length","Infinity","clearAborter","getParams","errorDeadline","errorTimeout","race","then","errorHandlerResult"],"sources":["C:/Users/yyash/Coding/solana-brkout/frontend/node_modules/@trezor/utils/lib/scheduleAction.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.scheduleAction = void 0;\nconst isArray = (attempts) => Array.isArray(attempts);\nconst resolveAfterMs = (ms, clear) => new Promise((resolve, reject) => {\n    if (clear.aborted)\n        return reject();\n    if (ms === undefined)\n        return resolve();\n    let timeout;\n    const onClear = () => {\n        clearTimeout(timeout);\n        clear.removeEventListener('abort', onClear);\n        reject();\n    };\n    timeout = setTimeout(() => {\n        clear.removeEventListener('abort', onClear);\n        resolve();\n    }, ms);\n    clear.addEventListener('abort', onClear);\n});\nconst rejectAfterMs = (ms, reason, clear) => new Promise((_, reject) => {\n    if (clear.aborted)\n        return reject();\n    let timeout;\n    const onClear = () => {\n        clearTimeout(timeout);\n        clear.removeEventListener('abort', onClear);\n        reject();\n    };\n    timeout = setTimeout(() => {\n        clear.removeEventListener('abort', onClear);\n        reject(reason);\n    }, ms);\n    clear.addEventListener('abort', onClear);\n});\nconst maybeRejectAfterMs = (ms, reason, clear) => ms === undefined ? [] : [rejectAfterMs(ms, reason, clear)];\nconst rejectWhenAborted = (signal, clear) => new Promise((_, reject) => {\n    if (clear.aborted)\n        return reject();\n    const errorSignal = new Error('Aborted by signal');\n    if (signal?.aborted)\n        return reject(errorSignal);\n    const onAbort = () => reject(errorSignal);\n    signal?.addEventListener('abort', onAbort);\n    const onClear = () => {\n        signal?.removeEventListener('abort', onAbort);\n        clear.removeEventListener('abort', onClear);\n        reject();\n    };\n    clear.addEventListener('abort', onClear);\n});\nconst resolveAction = async (action, clear) => {\n    const aborter = new AbortController();\n    if (clear.aborted)\n        aborter.abort();\n    const onClear = () => {\n        clear.removeEventListener('abort', onClear);\n        aborter.abort();\n    };\n    clear.addEventListener('abort', onClear);\n    try {\n        return await new Promise(resolve => resolve(action(aborter.signal)));\n    }\n    finally {\n        if (!clear.aborted)\n            clear.removeEventListener('abort', onClear);\n    }\n};\nconst attemptLoop = async (attempts, attempt, failure, clear) => {\n    for (let a = 0; a < attempts - 1; a++) {\n        if (clear.aborted)\n            break;\n        const aborter = new AbortController();\n        const onClear = () => aborter.abort();\n        clear.addEventListener('abort', onClear);\n        try {\n            return await attempt(a, aborter.signal);\n        }\n        catch (error) {\n            onClear();\n            await failure(a, error);\n        }\n        finally {\n            clear.removeEventListener('abort', onClear);\n        }\n    }\n    return clear.aborted ? Promise.reject() : attempt(attempts - 1, clear);\n};\nconst scheduleAction = async (action, params) => {\n    const { signal, delay, attempts, timeout, deadline, gap, attemptFailureHandler } = params;\n    const deadlineMs = deadline && deadline - Date.now();\n    const attemptCount = isArray(attempts)\n        ? attempts.length\n        : attempts ?? (deadline ? Infinity : 1);\n    const clearAborter = new AbortController();\n    const clear = clearAborter.signal;\n    const getParams = isArray(attempts)\n        ? (attempt) => attempts[attempt]\n        : () => ({ timeout, gap });\n    const errorDeadline = new Error('Aborted by deadline');\n    const errorTimeout = new Error('Aborted by timeout');\n    try {\n        return await Promise.race([\n            rejectWhenAborted(signal, clear),\n            ...maybeRejectAfterMs(deadlineMs, errorDeadline, clear),\n            resolveAfterMs(delay, clear).then(() => attemptLoop(attemptCount, (attempt, abort) => Promise.race([\n                ...maybeRejectAfterMs(getParams(attempt).timeout, errorTimeout, clear),\n                resolveAction(action, abort),\n            ]), (attempt, error) => {\n                const errorHandlerResult = attemptFailureHandler?.(error);\n                return errorHandlerResult\n                    ? Promise.reject(errorHandlerResult)\n                    : resolveAfterMs(getParams(attempt).gap ?? 0, clear);\n            }, clear)),\n        ]);\n    }\n    finally {\n        clearAborter.abort();\n    }\n};\nexports.scheduleAction = scheduleAction;\n//# sourceMappingURL=scheduleAction.js.map"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}