{"ast":null,"code":"export class Connection {\n  constructor(validatedOrigin, targetWindow) {\n    this.validatedOrigin = validatedOrigin;\n    this.targetWindow = targetWindow;\n    this.handlers = new Map();\n  }\n  off(event, callback) {\n    const eventCallbacks = this.handlers.get(event);\n    eventCallbacks === null || eventCallbacks === void 0 ? void 0 : eventCallbacks.delete(callback);\n  }\n  on(event, callback) {\n    var _a;\n    const eventCallbacks = (_a = this.handlers.get(event)) !== null && _a !== void 0 ? _a : new Set();\n    eventCallbacks.add(callback);\n    this.handlers.set(event, eventCallbacks);\n  }\n  send({\n    event,\n    payload\n  }) {\n    this.targetWindow.postMessage({\n      event,\n      payload\n    }, this.validatedOrigin);\n  }\n  runHandlersForEvent(event, payload) {\n    const eventCallbacks = this.handlers.get(event);\n    if (!eventCallbacks) {\n      return;\n    }\n    for (const callback of eventCallbacks) {\n      callback(payload);\n    }\n  }\n  resetHandlers() {\n    this.handlers.clear();\n  }\n  export() {\n    return {\n      off: this.off.bind(this),\n      on: this.on.bind(this),\n      send: this.send.bind(this),\n      validatedOrigin: this.validatedOrigin\n    };\n  }\n}","map":{"version":3,"names":["Connection","constructor","validatedOrigin","targetWindow","handlers","Map","off","event","callback","eventCallbacks","get","delete","on","_a","Set","add","set","send","payload","postMessage","runHandlersForEvent","resetHandlers","clear","export","bind"],"sources":["../../../src/core/connection.ts"],"sourcesContent":[null],"mappings":"AASA,OAAM,MAAOA,UAAU;EAGrBC,YACWC,eAAuB,EACvBC,YAAoB;IADpB,KAAAD,eAAe,GAAfA,eAAe;IACf,KAAAC,YAAY,GAAZA,YAAY;IAJN,KAAAC,QAAQ,GAAG,IAAIC,GAAG,EAAkC;EAKlE;EAEHC,GAAGA,CAACC,KAAiB,EAAEC,QAAuB;IAC5C,MAAMC,cAAc,GAAG,IAAI,CAACL,QAAQ,CAACM,GAAG,CAACH,KAAK,CAAC;IAC/CE,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEE,MAAM,CAACH,QAAQ,CAAC;EAClC;EAEAI,EAAEA,CAACL,KAAiB,EAAEC,QAAuB;;IAC3C,MAAMC,cAAc,GAAG,CAAAI,EAAA,OAAI,CAACT,QAAQ,CAACM,GAAG,CAACH,KAAK,CAAC,cAAAM,EAAA,cAAAA,EAAA,GAAI,IAAIC,GAAG,EAAiB;IAC3EL,cAAc,CAACM,GAAG,CAACP,QAAQ,CAAC;IAC5B,IAAI,CAACJ,QAAQ,CAACY,GAAG,CAACT,KAAK,EAAEE,cAAc,CAAC;EAC1C;EAEAQ,IAAIA,CAAC;IAAEV,KAAK;IAAEW;EAAO,CAA0C;IAC7D,IAAI,CAACf,YAAY,CAACgB,WAAW,CAC3B;MACEZ,KAAK;MACLW;KACD,EACD,IAAI,CAAChB,eAAe,CACrB;EACH;EAEAkB,mBAAmBA,CAACb,KAAiB,EAAEW,OAAgB;IACrD,MAAMT,cAAc,GAAG,IAAI,CAACL,QAAQ,CAACM,GAAG,CAACH,KAAK,CAAC;IAC/C,IAAI,CAACE,cAAc,EAAE;MACnB;;IAEF,KAAK,MAAMD,QAAQ,IAAIC,cAAc,EAAE;MACrCD,QAAQ,CAACU,OAAO,CAAC;;EAErB;EAEAG,aAAaA,CAAA;IACX,IAAI,CAACjB,QAAQ,CAACkB,KAAK,EAAE;EACvB;EAEAC,MAAMA,CAAA;IACJ,OAAO;MACLjB,GAAG,EAAE,IAAI,CAACA,GAAG,CAACkB,IAAI,CAAC,IAAI,CAAC;MACxBZ,EAAE,EAAE,IAAI,CAACA,EAAE,CAACY,IAAI,CAAC,IAAI,CAAC;MACtBP,IAAI,EAAE,IAAI,CAACA,IAAI,CAACO,IAAI,CAAC,IAAI,CAAC;MAC1BtB,eAAe,EAAE,IAAI,CAACA;KACvB;EACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}