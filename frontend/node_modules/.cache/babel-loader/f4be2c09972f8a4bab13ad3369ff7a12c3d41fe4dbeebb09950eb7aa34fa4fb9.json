{"ast":null,"code":"import { AbiEventNotFoundError } from '../../errors/abi.js';\nimport { FilterTypeNotSupportedError } from '../../errors/log.js';\nimport { toBytes } from '../encoding/toBytes.js';\nimport { keccak256 } from '../hash/keccak256.js';\nimport { toEventSelector } from '../hash/toEventSelector.js';\nimport { encodeAbiParameters } from './encodeAbiParameters.js';\nimport { formatAbiItem } from './formatAbiItem.js';\nimport { getAbiItem } from './getAbiItem.js';\nconst docsPath = '/docs/contract/encodeEventTopics';\nexport function encodeEventTopics(parameters) {\n  const {\n    abi,\n    eventName,\n    args\n  } = parameters;\n  let abiItem = abi[0];\n  if (eventName) {\n    const item = getAbiItem({\n      abi,\n      name: eventName\n    });\n    if (!item) throw new AbiEventNotFoundError(eventName, {\n      docsPath\n    });\n    abiItem = item;\n  }\n  if (abiItem.type !== 'event') throw new AbiEventNotFoundError(undefined, {\n    docsPath\n  });\n  const definition = formatAbiItem(abiItem);\n  const signature = toEventSelector(definition);\n  let topics = [];\n  if (args && 'inputs' in abiItem) {\n    const indexedInputs = abiItem.inputs?.filter(param => 'indexed' in param && param.indexed);\n    const args_ = Array.isArray(args) ? args : Object.values(args).length > 0 ? indexedInputs?.map(x => args[x.name]) ?? [] : [];\n    if (args_.length > 0) {\n      topics = indexedInputs?.map((param, i) => {\n        if (Array.isArray(args_[i])) return args_[i].map((_, j) => encodeArg({\n          param,\n          value: args_[i][j]\n        }));\n        return typeof args_[i] !== 'undefined' && args_[i] !== null ? encodeArg({\n          param,\n          value: args_[i]\n        }) : null;\n      }) ?? [];\n    }\n  }\n  return [signature, ...topics];\n}\nfunction encodeArg({\n  param,\n  value\n}) {\n  if (param.type === 'string' || param.type === 'bytes') return keccak256(toBytes(value));\n  if (param.type === 'tuple' || param.type.match(/^(.*)\\[(\\d+)?\\]$/)) throw new FilterTypeNotSupportedError(param.type);\n  return encodeAbiParameters([param], [value]);\n}\n//# sourceMappingURL=encodeEventTopics.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}