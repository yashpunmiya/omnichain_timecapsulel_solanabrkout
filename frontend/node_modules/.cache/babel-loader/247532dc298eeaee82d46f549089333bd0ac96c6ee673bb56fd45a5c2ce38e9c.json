{"ast":null,"code":"import { fallback, http } from 'viem';\nimport { ConstantsUtil } from '@reown/appkit-common';\nimport { ChainController, StorageUtil } from '@reown/appkit-controllers';\nimport { PresetsUtil } from './PresetsUtil.js';\nconst RPC_URL_HOST = 'rpc.walletconnect.org';\nexport function getBlockchainApiRpcUrl(caipNetworkId, projectId) {\n  const url = new URL('https://rpc.walletconnect.org/v1/');\n  url.searchParams.set('chainId', caipNetworkId);\n  url.searchParams.set('projectId', projectId);\n  return url.toString();\n}\nconst WC_HTTP_RPC_SUPPORTED_CHAINS = ['near:mainnet', 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp', 'eip155:1101', 'eip155:56', 'eip155:42161', 'eip155:7777777', 'eip155:59144', 'eip155:324', 'solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1', 'eip155:5000', 'solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz', 'eip155:80084', 'eip155:5003', 'eip155:100', 'eip155:8453', 'eip155:42220', 'eip155:1313161555', 'eip155:17000', 'eip155:1', 'eip155:300', 'eip155:1313161554', 'eip155:1329', 'eip155:84532', 'eip155:421614', 'eip155:11155111', 'eip155:8217', 'eip155:43114', 'solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z', 'eip155:999999999', 'eip155:11155420', 'eip155:80002', 'eip155:97', 'eip155:43113', 'eip155:137', 'eip155:10', 'eip155:1301', 'bip122:000000000019d6689c085ae165831e93', 'bip122:000000000933ea01ad0ee984209779ba'];\nexport const CaipNetworksUtil = {\n  extendRpcUrlWithProjectId(rpcUrl, projectId) {\n    let isReownUrl = false;\n    try {\n      const url = new URL(rpcUrl);\n      isReownUrl = url.host === RPC_URL_HOST;\n    } catch (e) {\n      isReownUrl = false;\n    }\n    if (isReownUrl) {\n      const url = new URL(rpcUrl);\n      if (!url.searchParams.has('projectId')) {\n        url.searchParams.set('projectId', projectId);\n      }\n      return url.toString();\n    }\n    return rpcUrl;\n  },\n  isCaipNetwork(network) {\n    return 'chainNamespace' in network && 'caipNetworkId' in network;\n  },\n  getChainNamespace(network) {\n    if (this.isCaipNetwork(network)) {\n      return network.chainNamespace;\n    }\n    return ConstantsUtil.CHAIN.EVM;\n  },\n  getCaipNetworkId(network) {\n    if (this.isCaipNetwork(network)) {\n      return network.caipNetworkId;\n    }\n    return `${ConstantsUtil.CHAIN.EVM}:${network.id}`;\n  },\n  getDefaultRpcUrl(caipNetwork, caipNetworkId, projectId) {\n    const defaultRpcUrl = caipNetwork.rpcUrls?.default?.http?.[0];\n    if (WC_HTTP_RPC_SUPPORTED_CHAINS.includes(caipNetworkId)) {\n      return getBlockchainApiRpcUrl(caipNetworkId, projectId);\n    }\n    return defaultRpcUrl || '';\n  },\n  extendCaipNetwork(caipNetwork, {\n    customNetworkImageUrls,\n    projectId,\n    customRpcUrls\n  }) {\n    const chainNamespace = this.getChainNamespace(caipNetwork);\n    const caipNetworkId = this.getCaipNetworkId(caipNetwork);\n    const networkDefaultRpcUrl = caipNetwork.rpcUrls.default.http?.[0];\n    const reownRpcUrl = this.getDefaultRpcUrl(caipNetwork, caipNetworkId, projectId);\n    const chainDefaultRpcUrl = caipNetwork?.rpcUrls?.['chainDefault']?.http?.[0] || networkDefaultRpcUrl;\n    const customRpcUrlsOfNetwork = customRpcUrls?.[caipNetworkId]?.map(i => i.url) || [];\n    const rpcUrls = [...customRpcUrlsOfNetwork, reownRpcUrl];\n    const rpcUrlsWithoutReown = [...customRpcUrlsOfNetwork];\n    if (chainDefaultRpcUrl && !rpcUrlsWithoutReown.includes(chainDefaultRpcUrl)) {\n      rpcUrlsWithoutReown.push(chainDefaultRpcUrl);\n    }\n    return {\n      ...caipNetwork,\n      chainNamespace,\n      caipNetworkId,\n      assets: {\n        imageId: PresetsUtil.NetworkImageIds[caipNetwork.id],\n        imageUrl: customNetworkImageUrls?.[caipNetwork.id]\n      },\n      rpcUrls: {\n        ...caipNetwork.rpcUrls,\n        default: {\n          http: rpcUrls\n        },\n        chainDefault: {\n          http: rpcUrlsWithoutReown\n        }\n      }\n    };\n  },\n  extendCaipNetworks(caipNetworks, {\n    customNetworkImageUrls,\n    projectId,\n    customRpcUrls\n  }) {\n    return caipNetworks.map(caipNetwork => CaipNetworksUtil.extendCaipNetwork(caipNetwork, {\n      customNetworkImageUrls,\n      customRpcUrls,\n      projectId\n    }));\n  },\n  getViemTransport(caipNetwork, projectId, customRpcUrls) {\n    const transports = [];\n    customRpcUrls?.forEach(rpcUrl => {\n      transports.push(http(rpcUrl.url, rpcUrl.config));\n    });\n    if (WC_HTTP_RPC_SUPPORTED_CHAINS.includes(caipNetwork.caipNetworkId)) {\n      const reownRpcUrl = this.getDefaultRpcUrl(caipNetwork, caipNetwork.caipNetworkId, projectId);\n      transports.push(http(reownRpcUrl, {\n        fetchOptions: {\n          headers: {\n            'Content-Type': 'text/plain'\n          }\n        }\n      }));\n    }\n    return fallback(transports);\n  },\n  extendWagmiTransports(caipNetwork, projectId, transport) {\n    if (WC_HTTP_RPC_SUPPORTED_CHAINS.includes(caipNetwork.caipNetworkId)) {\n      const reownRpcUrl = this.getDefaultRpcUrl(caipNetwork, caipNetwork.caipNetworkId, projectId);\n      return fallback([transport, http(reownRpcUrl)]);\n    }\n    return transport;\n  },\n  getUnsupportedNetwork(caipNetworkId) {\n    return {\n      id: caipNetworkId.split(':')[1],\n      caipNetworkId,\n      name: ConstantsUtil.UNSUPPORTED_NETWORK_NAME,\n      chainNamespace: caipNetworkId.split(':')[0],\n      nativeCurrency: {\n        name: '',\n        decimals: 0,\n        symbol: ''\n      },\n      rpcUrls: {\n        default: {\n          http: []\n        }\n      }\n    };\n  },\n  getCaipNetworkFromStorage(defaultCaipNetwork) {\n    const caipNetworkIdFromStorage = StorageUtil.getActiveCaipNetworkId();\n    const caipNetworks = ChainController.getAllRequestedCaipNetworks();\n    const availableNamespaces = Array.from(ChainController.state.chains?.keys() || []);\n    const namespace = caipNetworkIdFromStorage?.split(':')[0];\n    const isNamespaceAvailable = namespace ? availableNamespaces.includes(namespace) : false;\n    const caipNetwork = caipNetworks?.find(cn => cn.caipNetworkId === caipNetworkIdFromStorage);\n    const isUnsupportedNetwork = isNamespaceAvailable && !caipNetwork && caipNetworkIdFromStorage;\n    if (isUnsupportedNetwork) {\n      return this.getUnsupportedNetwork(caipNetworkIdFromStorage);\n    }\n    if (caipNetwork) {\n      return caipNetwork;\n    }\n    if (defaultCaipNetwork) {\n      return defaultCaipNetwork;\n    }\n    return caipNetworks?.[0];\n  }\n};","map":{"version":3,"names":["fallback","http","ConstantsUtil","ChainController","StorageUtil","PresetsUtil","RPC_URL_HOST","getBlockchainApiRpcUrl","caipNetworkId","projectId","url","URL","searchParams","set","toString","WC_HTTP_RPC_SUPPORTED_CHAINS","CaipNetworksUtil","extendRpcUrlWithProjectId","rpcUrl","isReownUrl","host","e","has","isCaipNetwork","network","getChainNamespace","chainNamespace","CHAIN","EVM","getCaipNetworkId","id","getDefaultRpcUrl","caipNetwork","defaultRpcUrl","rpcUrls","default","includes","extendCaipNetwork","customNetworkImageUrls","customRpcUrls","networkDefaultRpcUrl","reownRpcUrl","chainDefaultRpcUrl","customRpcUrlsOfNetwork","map","i","rpcUrlsWithoutReown","push","assets","imageId","NetworkImageIds","imageUrl","chainDefault","extendCaipNetworks","caipNetworks","getViemTransport","transports","forEach","config","fetchOptions","headers","extendWagmiTransports","transport","getUnsupportedNetwork","split","name","UNSUPPORTED_NETWORK_NAME","nativeCurrency","decimals","symbol","getCaipNetworkFromStorage","defaultCaipNetwork","caipNetworkIdFromStorage","getActiveCaipNetworkId","getAllRequestedCaipNetworks","availableNamespaces","Array","from","state","chains","keys","namespace","isNamespaceAvailable","find","cn","isUnsupportedNetwork"],"sources":["../../../src/CaipNetworkUtil.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}