{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createLazy = void 0;\nconst createDeferred_1 = require(\"./createDeferred\");\nconst createLazy = (initLazy, disposeLazy) => {\n  let value;\n  let valuePromise;\n  const get = () => value;\n  const getPending = () => valuePromise?.promise;\n  const dispose = () => {\n    if (valuePromise) {\n      valuePromise.reject(new Error('Disposed during initialization'));\n      valuePromise = undefined;\n    }\n    if (value !== undefined) {\n      disposeLazy?.(value);\n      value = undefined;\n    }\n  };\n  const getOrInit = (...args) => {\n    if (value !== undefined) return Promise.resolve(value);\n    if (!valuePromise) {\n      const deferred = (0, createDeferred_1.createDeferred)();\n      valuePromise = deferred;\n      initLazy(...args).then(val => {\n        value = val;\n        valuePromise = undefined;\n        deferred.resolve(val);\n      }).catch(err => {\n        valuePromise = undefined;\n        deferred.reject(err);\n      });\n    }\n    return valuePromise.promise;\n  };\n  return {\n    get,\n    getPending,\n    getOrInit,\n    dispose\n  };\n};\nexports.createLazy = createLazy;\n//# sourceMappingURL=createLazy.js.map","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}