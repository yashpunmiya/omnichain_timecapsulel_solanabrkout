{"ast":null,"code":"import { WalletReadyState } from '@solana/wallet-adapter-base';\nimport { useWallet } from '@solana/wallet-adapter-react';\nimport React, { useCallback, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { Collapse } from './Collapse.js';\nimport { WalletListItem } from './WalletListItem.js';\nimport { WalletSVG } from './WalletSVG.js';\nimport { useWalletModal } from './useWalletModal.js';\nexport const WalletModal = ({\n  className = '',\n  container = 'body'\n}) => {\n  const ref = useRef(null);\n  const {\n    wallets,\n    select\n  } = useWallet();\n  const {\n    setVisible\n  } = useWalletModal();\n  const [expanded, setExpanded] = useState(false);\n  const [fadeIn, setFadeIn] = useState(false);\n  const [portal, setPortal] = useState(null);\n  const [listedWallets, collapsedWallets] = useMemo(() => {\n    const installed = [];\n    const notInstalled = [];\n    for (const wallet of wallets) {\n      if (wallet.readyState === WalletReadyState.Installed) {\n        installed.push(wallet);\n      } else {\n        notInstalled.push(wallet);\n      }\n    }\n    return installed.length ? [installed, notInstalled] : [notInstalled, []];\n  }, [wallets]);\n  const hideModal = useCallback(() => {\n    setFadeIn(false);\n    setTimeout(() => setVisible(false), 150);\n  }, [setVisible]);\n  const handleClose = useCallback(event => {\n    event.preventDefault();\n    hideModal();\n  }, [hideModal]);\n  const handleWalletClick = useCallback((event, walletName) => {\n    select(walletName);\n    handleClose(event);\n  }, [select, handleClose]);\n  const handleCollapseClick = useCallback(() => setExpanded(!expanded), [expanded]);\n  const handleTabKey = useCallback(event => {\n    const node = ref.current;\n    if (!node) return;\n    // here we query all focusable elements\n    const focusableElements = node.querySelectorAll('button');\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const firstElement = focusableElements[0];\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const lastElement = focusableElements[focusableElements.length - 1];\n    if (event.shiftKey) {\n      // if going backward by pressing tab and firstElement is active, shift focus to last focusable element\n      if (document.activeElement === firstElement) {\n        lastElement.focus();\n        event.preventDefault();\n      }\n    } else {\n      // if going forward by pressing tab and lastElement is active, shift focus to first focusable element\n      if (document.activeElement === lastElement) {\n        firstElement.focus();\n        event.preventDefault();\n      }\n    }\n  }, [ref]);\n  useLayoutEffect(() => {\n    const handleKeyDown = event => {\n      if (event.key === 'Escape') {\n        hideModal();\n      } else if (event.key === 'Tab') {\n        handleTabKey(event);\n      }\n    };\n    // Get original overflow\n    const {\n      overflow\n    } = window.getComputedStyle(document.body);\n    // Hack to enable fade in animation after mount\n    setTimeout(() => setFadeIn(true), 0);\n    // Prevent scrolling on mount\n    document.body.style.overflow = 'hidden';\n    // Listen for keydown events\n    window.addEventListener('keydown', handleKeyDown, false);\n    return () => {\n      // Re-enable scrolling when component unmounts\n      document.body.style.overflow = overflow;\n      window.removeEventListener('keydown', handleKeyDown, false);\n    };\n  }, [hideModal, handleTabKey]);\n  useLayoutEffect(() => setPortal(document.querySelector(container)), [container]);\n  return portal && createPortal(React.createElement(\"div\", {\n    \"aria-labelledby\": \"wallet-adapter-modal-title\",\n    \"aria-modal\": \"true\",\n    className: `wallet-adapter-modal ${fadeIn && 'wallet-adapter-modal-fade-in'} ${className}`,\n    ref: ref,\n    role: \"dialog\"\n  }, React.createElement(\"div\", {\n    className: \"wallet-adapter-modal-container\"\n  }, React.createElement(\"div\", {\n    className: \"wallet-adapter-modal-wrapper\"\n  }, React.createElement(\"button\", {\n    onClick: handleClose,\n    className: \"wallet-adapter-modal-button-close\"\n  }, React.createElement(\"svg\", {\n    width: \"14\",\n    height: \"14\"\n  }, React.createElement(\"path\", {\n    d: \"M14 12.461 8.3 6.772l5.234-5.233L12.006 0 6.772 5.234 1.54 0 0 1.539l5.234 5.233L0 12.006l1.539 1.528L6.772 8.3l5.69 5.7L14 12.461z\"\n  }))), listedWallets.length ? React.createElement(React.Fragment, null, React.createElement(\"h1\", {\n    className: \"wallet-adapter-modal-title\"\n  }, \"Connect a wallet on Solana to continue\"), React.createElement(\"ul\", {\n    className: \"wallet-adapter-modal-list\"\n  }, listedWallets.map(wallet => React.createElement(WalletListItem, {\n    key: wallet.adapter.name,\n    handleClick: event => handleWalletClick(event, wallet.adapter.name),\n    wallet: wallet\n  })), collapsedWallets.length ? React.createElement(Collapse, {\n    expanded: expanded,\n    id: \"wallet-adapter-modal-collapse\"\n  }, collapsedWallets.map(wallet => React.createElement(WalletListItem, {\n    key: wallet.adapter.name,\n    handleClick: event => handleWalletClick(event, wallet.adapter.name),\n    tabIndex: expanded ? 0 : -1,\n    wallet: wallet\n  }))) : null), collapsedWallets.length ? React.createElement(\"button\", {\n    className: \"wallet-adapter-modal-list-more\",\n    onClick: handleCollapseClick,\n    tabIndex: 0\n  }, React.createElement(\"span\", null, expanded ? 'Less ' : 'More ', \"options\"), React.createElement(\"svg\", {\n    width: \"13\",\n    height: \"7\",\n    viewBox: \"0 0 13 7\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    className: `${expanded ? 'wallet-adapter-modal-list-more-icon-rotate' : ''}`\n  }, React.createElement(\"path\", {\n    d: \"M0.71418 1.626L5.83323 6.26188C5.91574 6.33657 6.0181 6.39652 6.13327 6.43762C6.24844 6.47872 6.37371 6.5 6.50048 6.5C6.62725 6.5 6.75252 6.47872 6.8677 6.43762C6.98287 6.39652 7.08523 6.33657 7.16774 6.26188L12.2868 1.626C12.7753 1.1835 12.3703 0.5 11.6195 0.5H1.37997C0.629216 0.5 0.224175 1.1835 0.71418 1.626Z\"\n  }))) : null) : React.createElement(React.Fragment, null, React.createElement(\"h1\", {\n    className: \"wallet-adapter-modal-title\"\n  }, \"You'll need a wallet on Solana to continue\"), React.createElement(\"div\", {\n    className: \"wallet-adapter-modal-middle\"\n  }, React.createElement(WalletSVG, null)), collapsedWallets.length ? React.createElement(React.Fragment, null, React.createElement(\"button\", {\n    className: \"wallet-adapter-modal-list-more\",\n    onClick: handleCollapseClick,\n    tabIndex: 0\n  }, React.createElement(\"span\", null, expanded ? 'Hide ' : 'Already have a wallet? View ', \"options\"), React.createElement(\"svg\", {\n    width: \"13\",\n    height: \"7\",\n    viewBox: \"0 0 13 7\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    className: `${expanded ? 'wallet-adapter-modal-list-more-icon-rotate' : ''}`\n  }, React.createElement(\"path\", {\n    d: \"M0.71418 1.626L5.83323 6.26188C5.91574 6.33657 6.0181 6.39652 6.13327 6.43762C6.24844 6.47872 6.37371 6.5 6.50048 6.5C6.62725 6.5 6.75252 6.47872 6.8677 6.43762C6.98287 6.39652 7.08523 6.33657 7.16774 6.26188L12.2868 1.626C12.7753 1.1835 12.3703 0.5 11.6195 0.5H1.37997C0.629216 0.5 0.224175 1.1835 0.71418 1.626Z\"\n  }))), React.createElement(Collapse, {\n    expanded: expanded,\n    id: \"wallet-adapter-modal-collapse\"\n  }, React.createElement(\"ul\", {\n    className: \"wallet-adapter-modal-list\"\n  }, collapsedWallets.map(wallet => React.createElement(WalletListItem, {\n    key: wallet.adapter.name,\n    handleClick: event => handleWalletClick(event, wallet.adapter.name),\n    tabIndex: expanded ? 0 : -1,\n    wallet: wallet\n  }))))) : null))), React.createElement(\"div\", {\n    className: \"wallet-adapter-modal-overlay\",\n    onMouseDown: handleClose\n  })), portal);\n};\n//# sourceMappingURL=WalletModal.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}