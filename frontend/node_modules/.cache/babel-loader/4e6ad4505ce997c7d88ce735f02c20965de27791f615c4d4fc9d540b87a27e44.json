{"ast":null,"code":"/**\n * @description Parses EIP-4361 formatted message into message fields object.\n *\n * @see https://eips.ethereum.org/EIPS/eip-4361\n *\n * @returns EIP-4361 fields object\n */\nexport function parseSiweMessage(message) {\n  const {\n    scheme,\n    statement,\n    ...prefix\n  } = message.match(prefixRegex)?.groups ?? {};\n  const {\n    chainId,\n    expirationTime,\n    issuedAt,\n    notBefore,\n    requestId,\n    ...suffix\n  } = message.match(suffixRegex)?.groups ?? {};\n  const resources = message.split('Resources:')[1]?.split('\\n- ').slice(1);\n  return {\n    ...prefix,\n    ...suffix,\n    ...(chainId ? {\n      chainId: Number(chainId)\n    } : {}),\n    ...(expirationTime ? {\n      expirationTime: new Date(expirationTime)\n    } : {}),\n    ...(issuedAt ? {\n      issuedAt: new Date(issuedAt)\n    } : {}),\n    ...(notBefore ? {\n      notBefore: new Date(notBefore)\n    } : {}),\n    ...(requestId ? {\n      requestId\n    } : {}),\n    ...(resources ? {\n      resources\n    } : {}),\n    ...(scheme ? {\n      scheme\n    } : {}),\n    ...(statement ? {\n      statement\n    } : {})\n  };\n}\n// https://regexr.com/80gdj\nconst prefixRegex = /^(?:(?<scheme>[a-zA-Z][a-zA-Z0-9+-.]*):\\/\\/)?(?<domain>[a-zA-Z0-9+-.]*(?::[0-9]{1,5})?) (?:wants you to sign in with your Ethereum account:\\n)(?<address>0x[a-fA-F0-9]{40})\\n\\n(?:(?<statement>.*)\\n\\n)?/;\n// https://regexr.com/80gf9\nconst suffixRegex = /(?:URI: (?<uri>.+))\\n(?:Version: (?<version>.+))\\n(?:Chain ID: (?<chainId>\\d+))\\n(?:Nonce: (?<nonce>[a-zA-Z0-9]+))\\n(?:Issued At: (?<issuedAt>.+))(?:\\nExpiration Time: (?<expirationTime>.+))?(?:\\nNot Before: (?<notBefore>.+))?(?:\\nRequest ID: (?<requestId>.+))?/;\n//# sourceMappingURL=parseSiweMessage.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}